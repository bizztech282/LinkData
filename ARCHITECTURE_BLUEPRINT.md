# Starlinkdirect - Architecture Blueprint

## ğŸ›ï¸ System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Web Browser    â”‚              â”‚  Mobile Browser  â”‚             â”‚
â”‚  â”‚  (Desktop/Laptop)â”‚              â”‚   (Smartphone)   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚           â”‚                                  â”‚                        â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                          â”‚ HTTPS                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚     WEB SERVER LAYER                       â”‚
â”‚                          â–¼                                            â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚              â”‚   Gunicorn (WSGI)    â”‚                                â”‚
â”‚              â”‚   - 3 Workers        â”‚                                â”‚
â”‚              â”‚   - 2 Threads/Worker â”‚                                â”‚
â”‚              â”‚   - 120s Timeout     â”‚                                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                         â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚    APPLICATION LAYER                        â”‚
â”‚                         â–¼                                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚         â”‚      Django 5.2.7 Framework       â”‚                        â”‚
â”‚         â”‚                                   â”‚                        â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                        â”‚
â”‚         â”‚  â”‚   Middleware Stack          â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  - SecurityMiddleware       â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  - WhiteNoiseMiddleware     â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  - SessionMiddleware        â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  - CSRFViewMiddleware       â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  - AuthenticationMiddleware â”‚  â”‚                        â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                        â”‚
â”‚         â”‚                                   â”‚                        â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                        â”‚
â”‚         â”‚  â”‚   URL Routing               â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  /              â†’ index      â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  /payment/      â†’ payment    â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  /api/stk-push/ â†’ initiate   â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  /api/mpesa/callback â†’ cb    â”‚  â”‚                        â”‚
â”‚         â”‚  â”‚  /admin/        â†’ admin      â”‚  â”‚                        â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                         â”‚                                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚         â”‚                               â”‚                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚    â”‚  Views   â”‚                  â”‚  Templates  â”‚                    â”‚
â”‚    â”‚          â”‚                  â”‚             â”‚                    â”‚
â”‚    â”‚ index()  â”‚â”€â”€â”€â”€â”€â”€rendersâ”€â”€â”€â”€â–¶â”‚ index.html  â”‚                    â”‚
â”‚    â”‚ payment()â”‚â”€â”€â”€â”€â”€â”€rendersâ”€â”€â”€â”€â–¶â”‚payment.html â”‚                    â”‚
â”‚    â”‚          â”‚                  â”‚             â”‚                    â”‚
â”‚    â”‚ initiate_â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚    â”‚ stk()    â”‚                                                      â”‚
â”‚    â”‚          â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚    â”‚ mpesa_   â”‚                  â”‚Static Files â”‚                    â”‚
â”‚    â”‚ callback()â”‚â—€â”€â”€â”€â”€servesâ”€â”€â”€â”€â”€â”€â”‚ - CSS       â”‚                    â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                  â”‚ - JS        â”‚                    â”‚
â”‚         â”‚                        â”‚ - Images    â”‚                    â”‚
â”‚         â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚         â”‚                                                             â”‚
â”‚         â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€callsâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚PayheroServiceâ”‚                   â”‚
â”‚                                  â”‚             â”‚                    â”‚
â”‚                                  â”‚ - Format    â”‚                    â”‚
â”‚                                  â”‚   Phone     â”‚                    â”‚
â”‚                                  â”‚ - Build     â”‚                    â”‚
â”‚                                  â”‚   Payload   â”‚                    â”‚
â”‚                                  â”‚ - HTTP POST â”‚                    â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXTERNAL SERVICES    â”‚                           â”‚
â”‚                                         â”‚                           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚           PayHero API (M-Pesa Gateway)               â”‚        â”‚
â”‚    â”‚  https://backend.payhero.co.ke/api/v2/payments       â”‚        â”‚
â”‚    â”‚                                                       â”‚        â”‚
â”‚    â”‚  - Receives STK Push request                         â”‚        â”‚
â”‚    â”‚  - Initiates M-Pesa prompt to user's phone           â”‚        â”‚
â”‚    â”‚  - Sends callback on payment completion              â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                            â”‚                                         â”‚
â”‚                            â–¼                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚    â”‚         Safaricom M-Pesa Infrastructure            â”‚           â”‚
â”‚    â”‚                                                    â”‚           â”‚
â”‚    â”‚  - Sends STK Push to user's phone                 â”‚           â”‚
â”‚    â”‚  - Processes payment                              â”‚           â”‚
â”‚    â”‚  - Returns result to PayHero                      â”‚           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DATA LAYER                                     â”‚
â”‚                                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚  Development DB     â”‚         â”‚   Production DB      â”‚        â”‚
â”‚    â”‚   SQLite            â”‚         â”‚   PostgreSQL         â”‚        â”‚
â”‚    â”‚   (db.sqlite3)      â”‚         â”‚   (Render/Railway)   â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                      â”‚
â”‚    âš ï¸  Currently: NO MODELS - Database not actively used            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagrams

### 1. Bundle Selection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 1. Visits homepage
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GET /          â”‚
â”‚  index.html     â”‚
â”‚                 â”‚
â”‚  Displays:      â”‚
â”‚  - Daily (2GB,  â”‚
â”‚    5GB)         â”‚
â”‚  - Weekly       â”‚
â”‚    (8.75GB,     â”‚
â”‚    15GB)        â”‚
â”‚  - Monthly      â”‚
â”‚    (25GB, 50GB) â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 2. Clicks "Buy Now"
     â”‚    (e.g., 2GB @ Ksh 150)
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redirect to:                   â”‚
â”‚  /payment/?amount=150&          â”‚
â”‚  detail=2GB%20(24Hrs)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Automatic Payment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 1. On payment page
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  payment.html           â”‚
â”‚  (Automatic Mode)       â”‚
â”‚                         â”‚
â”‚  Inputs:                â”‚
â”‚  - Payment Phone        â”‚
â”‚  - Recipient Phone      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 2. Clicks "Pay Now"
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JavaScript             â”‚
â”‚  - Validates inputs     â”‚
â”‚  - Shows loading state  â”‚
â”‚  - Sends POST request   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 3. POST /api/stk-push/
     â”‚    {
     â”‚      phone_number: "0712345678",
     â”‚      recipient_phone: "0712345678",
     â”‚      amount: "150"
     â”‚    }
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Django View: initiate_stk()    â”‚
â”‚                                 â”‚
â”‚  1. Parse JSON body             â”‚
â”‚  2. Validate inputs             â”‚
â”‚  3. Generate reference          â”‚
â”‚     (TXN-XXXXXXXX)              â”‚
â”‚  4. Call PayheroService         â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 4. Calls PayHero API
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PayheroService                 â”‚
â”‚                                 â”‚
â”‚  1. Format phone (254...)       â”‚
â”‚  2. Validate channel_id         â”‚
â”‚  3. Build payload:              â”‚
â”‚     {                           â”‚
â”‚       amount: 150,              â”‚
â”‚       phone_number: "254...",   â”‚
â”‚       channel_id: 12345,        â”‚
â”‚       provider: "m-pesa",       â”‚
â”‚       external_reference: "...", â”‚
â”‚       callback_url: "..."       â”‚
â”‚     }                           â”‚
â”‚  4. POST to PayHero             â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 5. HTTP POST (Basic Auth)
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PayHero API                    â”‚
â”‚  backend.payhero.co.ke          â”‚
â”‚                                 â”‚
â”‚  1. Validates request           â”‚
â”‚  2. Initiates M-Pesa STK        â”‚
â”‚  3. Returns response            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 6. Response
     â”‚    {success: true, ...}
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Django View                    â”‚
â”‚  Returns JSON to frontend       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 7. JSON Response
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JavaScript                     â”‚
â”‚  - Hides loading                â”‚
â”‚  - Shows success message        â”‚
â”‚  - "STK Push sent! Check phone" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ Meanwhile...
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User's Phone                   â”‚
â”‚  - Receives M-Pesa prompt       â”‚
â”‚  - User enters PIN              â”‚
â”‚  - Payment processed            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 8. Payment complete
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PayHero                        â”‚
â”‚  Sends callback                 â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 9. POST /api/mpesa/callback
     â”‚    {
     â”‚      ResultCode: 0,
     â”‚      ExternalReference: "...",
     â”‚      ...
     â”‚    }
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Django View: mpesa_callback()  â”‚
â”‚                                 â”‚
â”‚  1. Logs callback data          â”‚
â”‚  2. TODO: Update transaction    â”‚
â”‚  3. Returns success             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Manual Payment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 1. On payment page
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  payment.html           â”‚
â”‚  Switches to Manual     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 2. Views instructions
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Till Number: 6944804           â”‚
â”‚  Amount: Ksh 150                â”‚
â”‚                                 â”‚
â”‚  Steps:                         â”‚
â”‚  1. M-Pesa â†’ Lipa na M-Pesa     â”‚
â”‚  2. Buy Goods                   â”‚
â”‚  3. Enter Till: 6944804         â”‚
â”‚  4. Enter Amount: 150           â”‚
â”‚  5. Enter PIN                   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 3. Completes payment
     â”‚    on M-Pesa
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User receives M-Pesa           â”‚
â”‚  confirmation code              â”‚
â”‚  (e.g., QA12BC34DE)             â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 4. Clicks WhatsApp button
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WhatsApp                       â”‚
â”‚  Pre-filled message:            â”‚
â”‚  "Hi! I just made a payment..." â”‚
â”‚  "Recipient Number: _____"      â”‚
â”‚  "M-Pesa Code: _____"           â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 5. Sends to +254782070228
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin/Support                  â”‚
â”‚  1. Verifies payment            â”‚
â”‚  2. Activates bundle manually   â”‚
â”‚  3. Confirms to customer        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—‚ï¸ File Structure & Responsibilities

```
starlinkdirect-main/
â”‚
â”œâ”€â”€ ğŸ“ starlinkdirect/              # Django Project Configuration
â”‚   â”œâ”€â”€ settings.py                 # âš™ï¸  Core settings
â”‚   â”‚   â”œâ”€â”€ Database config (SQLite/PostgreSQL)
â”‚   â”‚   â”œâ”€â”€ Static files (WhiteNoise)
â”‚   â”‚   â”œâ”€â”€ Middleware stack
â”‚   â”‚   â”œâ”€â”€ Security settings
â”‚   â”‚   â”œâ”€â”€ PayHero credentials
â”‚   â”‚   â””â”€â”€ Logging configuration
â”‚   â”‚
â”‚   â”œâ”€â”€ urls.py                     # ğŸ”— Root URL routing
â”‚   â”‚   â””â”€â”€ Includes bundles.urls
â”‚   â”‚
â”‚   â”œâ”€â”€ wsgi.py                     # ğŸš€ WSGI entry point
â”‚   â”‚   â””â”€â”€ Used by Gunicorn
â”‚   â”‚
â”‚   â””â”€â”€ asgi.py                     # ğŸš€ ASGI entry point
â”‚       â””â”€â”€ For async support (not used)
â”‚
â”œâ”€â”€ ğŸ“ bundles/                     # Main Application
â”‚   â”œâ”€â”€ views.py                    # ğŸ¯ Business Logic
â”‚   â”‚   â”œâ”€â”€ index()          â†’ Renders homepage
â”‚   â”‚   â”œâ”€â”€ payment()        â†’ Renders payment page
â”‚   â”‚   â”œâ”€â”€ initiate_stk()   â†’ Handles STK Push API
â”‚   â”‚   â””â”€â”€ mpesa_callback() â†’ Receives M-Pesa callbacks
â”‚   â”‚
â”‚   â”œâ”€â”€ urls.py                     # ğŸ”— App URL patterns
â”‚   â”‚   â”œâ”€â”€ /                â†’ index
â”‚   â”‚   â”œâ”€â”€ /payment/        â†’ payment
â”‚   â”‚   â”œâ”€â”€ /api/stk-push/   â†’ initiate_stk
â”‚   â”‚   â””â”€â”€ /api/mpesa/callback â†’ mpesa_callback
â”‚   â”‚
â”‚   â”œâ”€â”€ payhero_api.py              # ğŸ’³ PayHero Integration
â”‚   â”‚   â””â”€â”€ PayheroService
â”‚   â”‚       â”œâ”€â”€ initiate_stk_push()
â”‚   â”‚       â””â”€â”€ _format_phone_number()
â”‚   â”‚
â”‚   â”œâ”€â”€ models.py                   # ğŸ—„ï¸  Database Models
â”‚   â”‚   â””â”€â”€ (Currently empty)
â”‚   â”‚
â”‚   â”œâ”€â”€ admin.py                    # ğŸ‘¤ Admin Interface
â”‚   â”‚   â””â”€â”€ (Currently empty)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ templates/               # ğŸ¨ HTML Templates
â”‚       â”œâ”€â”€ index.html              # Homepage (bundle selection)
â”‚       â””â”€â”€ payment.html            # Payment page
â”‚
â”œâ”€â”€ ğŸ“ static/                      # ğŸ¨ Static Assets
â”‚   â”œâ”€â”€ ğŸ“ css/
â”‚   â”‚   â””â”€â”€ styles.css              # Custom styles (if any)
â”‚   â”œâ”€â”€ ğŸ“ js/
â”‚   â”‚   â””â”€â”€ main.js                 # Custom JavaScript (if any)
â”‚   â””â”€â”€ ğŸ“ img/
â”‚       â””â”€â”€ icon.png                # Starlink logo
â”‚
â”œâ”€â”€ ğŸ“ bundles/migrations/          # ğŸ—„ï¸  Database Migrations
â”‚   â””â”€â”€ __init__.py                 # (No migrations yet)
â”‚
â”œâ”€â”€ manage.py                       # ğŸ› ï¸  Django CLI
â”‚   â””â”€â”€ Entry point for all Django commands
â”‚
â”œâ”€â”€ requirements.txt                # ğŸ“¦ Python Dependencies
â”‚   â”œâ”€â”€ Django 5.2.7
â”‚   â”œâ”€â”€ gunicorn
â”‚   â”œâ”€â”€ whitenoise
â”‚   â”œâ”€â”€ dj-database-url
â”‚   â”œâ”€â”€ psycopg2-binary
â”‚   â”œâ”€â”€ requests
â”‚   â””â”€â”€ python-dotenv
â”‚
â”œâ”€â”€ build.sh                        # ğŸ—ï¸  Render Build Script
â”‚   â”œâ”€â”€ Install dependencies
â”‚   â””â”€â”€ Collect static files
â”‚
â”œâ”€â”€ railway_startup.sh              # ğŸš‚ Railway Startup Script
â”‚   â”œâ”€â”€ Run migrations
â”‚   â”œâ”€â”€ Create superuser
â”‚   â””â”€â”€ Start Gunicorn
â”‚
â”œâ”€â”€ Procfile                        # ğŸ“‹ Process Definition
â”‚   â””â”€â”€ web: bash railway_startup.sh
â”‚
â”œâ”€â”€ .gitignore                      # ğŸš« Git Ignore Rules
â”‚   â”œâ”€â”€ .env
â”‚   â”œâ”€â”€ db.sqlite3
â”‚   â”œâ”€â”€ __pycache__/
â”‚   â””â”€â”€ staticfiles/
â”‚
â””â”€â”€ DEPLOY_TO_RENDER.md             # ğŸ“– Deployment Guide
```

---

## ğŸ”Œ API Endpoints

### Public Endpoints

| Endpoint | Method | Auth | Purpose | Request | Response |
|----------|--------|------|---------|---------|----------|
| `/` | GET | None | Homepage | - | HTML (index.html) |
| `/payment/` | GET | None | Payment page | Query params: `amount`, `detail` | HTML (payment.html) |
| `/api/stk-push/` | POST | None | Initiate STK Push | JSON: `{phone_number, recipient_phone, amount}` | JSON: `{success, message, data}` |
| `/api/mpesa/callback` | POST | None | M-Pesa callback | JSON: PayHero callback data | JSON: `{ResultCode, ResultDesc}` |
| `/admin/` | GET | Django Admin | Admin panel | - | HTML (Django admin) |

### Static Files

| Path | Type | Purpose |
|------|------|---------|
| `/static/css/*` | CSS | Stylesheets |
| `/static/js/*` | JavaScript | Client-side scripts |
| `/static/img/*` | Images | Logo, icons |

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY LAYERS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: TRANSPORT SECURITY
â”œâ”€â”€ HTTPS Enforcement (Render/Railway)
â”œâ”€â”€ TLS 1.2+ encryption
â””â”€â”€ CSRF Trusted Origins

Layer 2: DJANGO MIDDLEWARE
â”œâ”€â”€ SecurityMiddleware
â”‚   â”œâ”€â”€ X-Content-Type-Options: nosniff
â”‚   â”œâ”€â”€ X-Frame-Options: DENY
â”‚   â””â”€â”€ X-XSS-Protection: 1; mode=block
â”œâ”€â”€ CSRFViewMiddleware
â”‚   â”œâ”€â”€ CSRF tokens on forms
â”‚   â””â”€â”€ Exempt: /api/stk-push/, /api/mpesa/callback
â””â”€â”€ SessionMiddleware
    â””â”€â”€ Secure session cookies

Layer 3: APPLICATION SECURITY
â”œâ”€â”€ Environment Variables
â”‚   â”œâ”€â”€ SECRET_KEY (not in code)
â”‚   â”œâ”€â”€ API credentials (not in code)
â”‚   â””â”€â”€ .env in .gitignore
â”œâ”€â”€ Input Validation
â”‚   â”œâ”€â”€ Phone number format (254...)
â”‚   â”œâ”€â”€ Amount validation
â”‚   â””â”€â”€ JSON parsing with error handling
â””â”€â”€ Error Handling
    â”œâ”€â”€ Try-catch blocks
    â”œâ”€â”€ Logging (not exposing sensitive data)
    â””â”€â”€ Generic error messages to users

Layer 4: EXTERNAL API SECURITY
â”œâ”€â”€ PayHero API
â”‚   â”œâ”€â”€ Basic Authentication
â”‚   â”œâ”€â”€ HTTPS only
â”‚   â””â”€â”€ Callback URL verification
â””â”€â”€ M-Pesa
    â””â”€â”€ Handled by PayHero

âš ï¸  MISSING SECURITY FEATURES:
â”œâ”€â”€ Rate limiting
â”œâ”€â”€ IP whitelisting for callbacks
â”œâ”€â”€ Webhook signature verification
â”œâ”€â”€ Database encryption
â””â”€â”€ User authentication
```

---

## ğŸ“Š Deployment Architecture

### Render Deployment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RENDER PLATFORM                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Web Service (Free Tier)                 â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚  â”‚  Build Phase                               â”‚     â”‚  â”‚
â”‚  â”‚  â”‚  1. git clone repository                   â”‚     â”‚  â”‚
â”‚  â”‚  â”‚  2. ./build.sh                             â”‚     â”‚  â”‚
â”‚  â”‚  â”‚     - pip install -r requirements.txt      â”‚     â”‚  â”‚
â”‚  â”‚  â”‚     - python manage.py collectstatic       â”‚     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚  â”‚  Runtime Phase                             â”‚     â”‚  â”‚
â”‚  â”‚  â”‚  - gunicorn starlinkdirect.wsgi            â”‚     â”‚  â”‚
â”‚  â”‚  â”‚  - Port: 10000                             â”‚     â”‚  â”‚
â”‚  â”‚  â”‚  - Workers: 1 (free tier)                  â”‚     â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Environment Variables:                             â”‚  â”‚
â”‚  â”‚  - SECRET_KEY                                       â”‚  â”‚
â”‚  â”‚  - DEBUG=False                                      â”‚  â”‚
â”‚  â”‚  - DATABASE_URL (PostgreSQL)                        â”‚  â”‚
â”‚  â”‚  - PAYHERO_* credentials                            â”‚  â”‚
â”‚  â”‚  - RENDER_EXTERNAL_HOSTNAME (auto)                  â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  âš ï¸  Free Tier Limitations:                          â”‚  â”‚
â”‚  â”‚  - Spins down after 15 min inactivity               â”‚  â”‚
â”‚  â”‚  - 50s-1min cold start                              â”‚  â”‚
â”‚  â”‚  - 512MB RAM                                        â”‚  â”‚
â”‚  â”‚  - Shared CPU                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         PostgreSQL Database (Free Tier)              â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  - 256MB storage                                    â”‚  â”‚
â”‚  â”‚  - Expires after 90 days                            â”‚  â”‚
â”‚  â”‚  - Internal URL (private network)                   â”‚  â”‚
â”‚  â”‚  - External URL (public access)                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Static Files (WhiteNoise)               â”‚  â”‚
â”‚  â”‚  - Served directly by Django                        â”‚  â”‚
â”‚  â”‚  - Compressed & cached                              â”‚  â”‚
â”‚  â”‚  - No separate CDN needed                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  Public URL: https://starlinkdirect.onrender.com           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

External Monitoring:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UptimeRobot        â”‚
â”‚   - Pings every 5min â”‚
â”‚   - Prevents sleep   â”‚
â”‚   - Critical for     â”‚
â”‚     M-Pesa callbacks â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Railway Deployment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   RAILWAY PLATFORM                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Web Service                             â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Procfile: web: bash railway_startup.sh             â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Startup Script:                                    â”‚  â”‚
â”‚  â”‚  1. python manage.py migrate                        â”‚  â”‚
â”‚  â”‚  2. Create superuser (if not exists)                â”‚  â”‚
â”‚  â”‚  3. gunicorn starlinkdirect.wsgi                    â”‚  â”‚
â”‚  â”‚     --timeout 120                                   â”‚  â”‚
â”‚  â”‚     --workers 3                                     â”‚  â”‚
â”‚  â”‚     --threads 2                                     â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Environment Variables:                             â”‚  â”‚
â”‚  â”‚  - SECRET_KEY                                       â”‚  â”‚
â”‚  â”‚  - DEBUG=False                                      â”‚  â”‚
â”‚  â”‚  - DATABASE_URL (auto-injected)                     â”‚  â”‚
â”‚  â”‚  - PAYHERO_* credentials                            â”‚  â”‚
â”‚  â”‚  - RAILWAY_PUBLIC_DOMAIN (auto)                     â”‚  â”‚
â”‚  â”‚  - ADMIN_USERNAME, ADMIN_EMAIL, ADMIN_PASSWORD      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  Public URL: https://[project].railway.app                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ State Management

### Current State (Stateless)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REQUEST LIFECYCLE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Request â†’ Django â†’ Process â†’ Response
   â†“                              â†“
No state stored              No persistence

âš ï¸  Implications:
- No transaction history
- No user sessions (beyond Django default)
- No order tracking
- Callback data logged but not saved
```

### Proposed State (With Database)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 STATEFUL ARCHITECTURE                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Request â†’ Django â†’ Process â†’ Save to DB â†’ Response
                      â†“
                   Database
                   â”œâ”€â”€ Transactions
                   â”œâ”€â”€ Bundles
                   â””â”€â”€ Users (optional)

âœ… Benefits:
- Transaction tracking
- Payment history
- Analytics
- Audit trail
- Customer portal
```

---

## ğŸ¯ Integration Points

### 1. PayHero API Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PAYHERO INTEGRATION                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Endpoint: https://backend.payhero.co.ke/api/v2/payments
Method: POST
Auth: Basic Authentication

Request Headers:
{
  "Content-Type": "application/json",
  "Authorization": "Basic [base64_encoded_credentials]"
}

Request Body:
{
  "amount": 150,
  "phone_number": "254712345678",
  "channel_id": 12345,
  "provider": "m-pesa",
  "external_reference": "TXN-A1B2C3D4",
  "customer_name": "Bundles for 254712345678",
  "callback_url": "https://yourdomain.com/api/mpesa/callback"
}

Response (Success):
{
  "success": true,
  "message": "STK Push initiated",
  "data": {
    "transaction_id": "...",
    "reference": "...",
    ...
  }
}

Callback (Async):
POST /api/mpesa/callback
{
  "ResultCode": 0,
  "ResultDesc": "Success",
  "ExternalReference": "TXN-A1B2C3D4",
  "TransactionID": "...",
  "Amount": 150,
  "PhoneNumber": "254712345678",
  ...
}
```

### 2. M-Pesa Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      M-PESA FLOW                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Starlinkdirect â†’ PayHero API
   "Initiate STK Push for 254712345678, Ksh 150"

2. PayHero â†’ Safaricom M-Pesa
   "Send STK Push to 254712345678"

3. Safaricom â†’ User's Phone
   "M-Pesa prompt: Pay Ksh 150 to [Business]"

4. User â†’ Safaricom
   "Enters PIN, confirms payment"

5. Safaricom â†’ PayHero
   "Payment successful, Transaction ID: QA12BC34DE"

6. PayHero â†’ Starlinkdirect
   "Callback: Payment confirmed for TXN-A1B2C3D4"

7. Starlinkdirect â†’ Database (TODO)
   "Update transaction status to 'completed'"

8. Starlinkdirect â†’ Starlink API (TODO)
   "Activate 2GB bundle for 254712345678"
```

---

## ğŸ“ˆ Scalability Considerations

### Current Capacity

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CURRENT LIMITS                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Free Tier (Render):
â”œâ”€â”€ Requests: ~100-200 concurrent
â”œâ”€â”€ Database: 256MB (minimal usage)
â”œâ”€â”€ RAM: 512MB
â”œâ”€â”€ CPU: Shared
â””â”€â”€ Cold Start: 50s-1min

Bottlenecks:
â”œâ”€â”€ PayHero API timeout (60s)
â”œâ”€â”€ Single-threaded request handling
â”œâ”€â”€ No caching
â””â”€â”€ No async processing
```

### Scaling Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SCALING ROADMAP                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Phase 1: Vertical Scaling (Paid Tier)
â”œâ”€â”€ Upgrade to paid Render plan
â”œâ”€â”€ Increase workers (3-5)
â”œâ”€â”€ Increase RAM (1-2GB)
â””â”€â”€ Persistent database

Phase 2: Horizontal Scaling
â”œâ”€â”€ Load balancer
â”œâ”€â”€ Multiple app instances
â”œâ”€â”€ Redis for caching
â””â”€â”€ Celery for async tasks

Phase 3: Microservices
â”œâ”€â”€ Separate payment service
â”œâ”€â”€ Separate bundle activation service
â”œâ”€â”€ API gateway
â””â”€â”€ Message queue (RabbitMQ/SQS)
```

---

## ğŸ¨ Frontend Architecture

### Component Hierarchy

```
index.html
â”œâ”€â”€ Header
â”‚   â””â”€â”€ Logo (Starlink)
â”œâ”€â”€ Main
â”‚   â”œâ”€â”€ Page Title
â”‚   â”œâ”€â”€ Daily Bundles Section
â”‚   â”‚   â”œâ”€â”€ Section Header (Icon + Title)
â”‚   â”‚   â””â”€â”€ Bundle Cards
â”‚   â”‚       â”œâ”€â”€ 2GB Card
â”‚   â”‚       â””â”€â”€ 5GB Card
â”‚   â”œâ”€â”€ Weekly Deals Section
â”‚   â”‚   â”œâ”€â”€ Section Header
â”‚   â”‚   â””â”€â”€ Bundle Cards
â”‚   â”‚       â”œâ”€â”€ 8.75GB Card
â”‚   â”‚       â””â”€â”€ 15GB Card (Recommended)
â”‚   â””â”€â”€ Monthly Value Section
â”‚       â”œâ”€â”€ Section Header
â”‚       â””â”€â”€ Bundle Cards
â”‚           â”œâ”€â”€ 25GB Card
â”‚           â””â”€â”€ 50GB Card
â””â”€â”€ Footer
    â””â”€â”€ Copyright + Security Info

payment.html
â”œâ”€â”€ Header
â”‚   â””â”€â”€ Logo
â”œâ”€â”€ Main
â”‚   â”œâ”€â”€ Page Title
â”‚   â”œâ”€â”€ Bundle Info Display
â”‚   â”œâ”€â”€ Payment Method Toggle
â”‚   â”‚   â”œâ”€â”€ Automatic Option
â”‚   â”‚   â””â”€â”€ Manual Option
â”‚   â”œâ”€â”€ Automatic Payment Section
â”‚   â”‚   â”œâ”€â”€ Instructions Card
â”‚   â”‚   â”œâ”€â”€ Payment Form
â”‚   â”‚   â”‚   â”œâ”€â”€ Payment Phone Input
â”‚   â”‚   â”‚   â””â”€â”€ Recipient Phone Input
â”‚   â”‚   â”œâ”€â”€ Pay Now Button
â”‚   â”‚   â””â”€â”€ Status Message
â”‚   â””â”€â”€ Manual Payment Section
â”‚       â”œâ”€â”€ Instructions Card
â”‚       â”œâ”€â”€ Till Number Display
â”‚       â”‚   â”œâ”€â”€ Number: 6944804
â”‚       â”‚   â””â”€â”€ Copy Button
â”‚       â”œâ”€â”€ Step-by-Step Guide
â”‚       â””â”€â”€ WhatsApp Button
â””â”€â”€ Footer
```

### JavaScript Functionality

```javascript
// index.html
goToPayment(amount, detail)
  â””â”€â”€ Redirects to /payment/ with query params

// payment.html
DOMContentLoaded
  â””â”€â”€ Loads bundle details from URL params

setPaymentMode(mode)
  â”œâ”€â”€ Toggles between auto/manual
  â”œâ”€â”€ Shows/hides sections
  â””â”€â”€ Re-renders Feather icons

copyTillNumber()
  â”œâ”€â”€ Copies till number to clipboard
  â””â”€â”€ Shows "Copied!" feedback

payNowBtn.click
  â”œâ”€â”€ Validates inputs
  â”œâ”€â”€ Shows loading state
  â”œâ”€â”€ Sends POST to /api/stk-push/
  â”œâ”€â”€ Handles response
  â””â”€â”€ Shows success/error message

getCookie(name)
  â””â”€â”€ Retrieves CSRF token
```

---

## ğŸ”® Future Architecture Vision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PROPOSED FUTURE ARCHITECTURE                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend   â”‚
â”‚  (React/Vue) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ REST API / GraphQL
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Gateway                           â”‚
â”‚  - Authentication                                        â”‚
â”‚  - Rate Limiting                                         â”‚
â”‚  - Request Routing                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼             â–¼             â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bundle    â”‚ â”‚ Payment  â”‚ â”‚   User   â”‚ â”‚  Analytics   â”‚
â”‚   Service   â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚   Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚             â”‚             â”‚              â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL  â”‚          â”‚  Redis Cache    â”‚
â”‚  (Primary DB)â”‚          â”‚  (Sessions/Jobs)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Message Queue                         â”‚
â”‚  - Celery / RabbitMQ                                     â”‚
â”‚  - Async bundle activation                               â”‚
â”‚  - Email notifications                                   â”‚
â”‚  - Webhook processing                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PayHero    â”‚ â”‚ Starlink â”‚ â”‚   Email      â”‚
â”‚    API      â”‚ â”‚   API    â”‚ â”‚   Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Blueprint Version:** 1.0  
**Last Updated:** January 15, 2026  
**Maintained By:** Development Team
